# 一、薪资管理 - 工资账套管理开发

## 1.1. 后端 - 查询工资账套列表接口 开发

Controller层

```java
@RestController
@RequestMapping("/salary/sob")
public class SalaryController {
  @Autowired
  SalaryService salaryService;
  @GetMapping("/")
  public List<Salary> getAllSalaries() {
    return salaryService.getAllSalaries();
  }
}
```

Service层

```java
@Service
public class SalaryService {
  @Autowired
  SalaryMapper salaryMapper;
  public List<Salary> getAllSalaries() {
    return salaryMapper.getAllSalaries();
  }
}
```

Mapper层

```xml
<select id="getAllSalaries" resultMap="BaseResultMap">
  select
  <include refid="Base_Column_List"/>
  from salary
</select>
```

## 1.2. 前端 - 组件开发、接口对接

前端：

```vue
<template>
<div>
  <div style="display: flex;justify-content: space-between">
    <el-button icon="el-icon-plus" type="primary" @click="showAddSalaryView">添加工资账套</el-button>
    <el-button icon="el-icon-refresh" type="success" @click="initSalaries"></el-button>
  </div>
  <div style="margin-top: 10px;">
    <el-table :data="salaries">
      <el-table-column type="selection" width="55"></el-table-column>
      <el-table-column width="120" prop="name" label="账套名称"></el-table-column>
      <el-table-column width="70" prop="basicSalary" label="基本工资"></el-table-column>
      <el-table-column width="70" prop="trafficSalary" label="交通补助"></el-table-column>
      <el-table-column width="70" prop="lunchSalary" label="午餐补助"></el-table-column>
      <el-table-column width="70" prop="bonus" label="奖金"></el-table-column>
      <el-table-column width="100" prop="createDate" label="启用时间"></el-table-column>
      <el-table-column label="养老金" align="center">
        <el-table-column width="70" prop="pensionPer" label="比率"></el-table-column>
        <el-table-column width="70" prop="pensionBase" label="基数"></el-table-column>
  </el-table-column>
      <el-table-column label="医疗保险" align="center">
        <el-table-column width="70" prop="medicalPer" label="比率"></el-table-column>
        <el-table-column width="70" prop="medicalBase" label="基数"></el-table-column>
  </el-table-column>
      <el-table-column label="公积金" align="center">
        <el-table-column width="70" prop="accumulationFundPer" label="比率"></el-table-column>
        <el-table-column width="70" prop="accumulationFundPer" label="基数"></el-table-column>
  </el-table-column>
      <el-table-column label="操作">
        <template>
          <el-button>编辑</el-button>
          <el-button type="danger">删除</el-button>
</template>
</el-table-column>
</el-table>
</div>
<el-dialog
           title="添加工资账套"
           :visible.sync="dialogVisible"
           width="50%">
  <div style="display: flex; justify-content: space-around;align-items: center">
    <el-steps direction="vertical" :active="activeItemIndex">
      <el-step :title="itemName" v-for="(itemName,index) in salaryItemName" :key="index"></el-step>
    </el-steps>
    <el-input v-model="salary[title]" :placeholder="'请输入'+ salaryItemName[index] +'...' "
              v-for="(value,title,index) in salary"
              :key="index" v-show="activeItemIndex==index" style="width: 200px;"></el-input>
  </div>
  <span slot="footer" class="dialog-footer">
    <el-button @click="preStep">{{activeItemIndex==10?'取消':'上一步'}}</el-button>
    <el-button type="primary" @click="nextStep">{{activeItemIndex==10?'完成':'下一步'}}</el-button>
  </span>
</el-dialog>
</div>
</template>

<script>
  export default {
    name: "SalSob",
    data() {
      return {
        salaries: [],
        dialogVisible: false,
        activeItemIndex: 0,
        salaryItemName: [
          '基本工资',
          '交通补助',
          '午餐补助',
          '奖金',
          '养老金比率',
          '养老金基数',
          '医疗保险比率',
          '医疗保险基数',
          '公积金比率',
          '公积金基数',
          '账套名称'
        ],
        salary: {
          basicSalary: 0,
          trafficSalary: 0,
          lunchSalary: 0,
          bonus: 0,
          pensionPer: 0,
          pensionBase: 0,
          medicalPer: 0,
          medicalBase: 0,
          accumulationFundPer: 0,
          accumulationFundBase: 0,
          name: ''
        }
      }
    },
    mounted() {
      this.initSalaries();
    },
    methods: {
      // 加载 Salary
      initSalaries() {
        this.getRequest("/salary/sob/").then(res => {
          if (res) {
            this.salaries = res;
          }
        })
      },
      // 点击展开弹窗
      showAddSalaryView() {
        this.dialogVisible = true
      },
      // 点击上一步或者完成
      nextStep() {
        if (this.activeItemIndex == 10) {
          return
        }
        this.activeItemIndex++
      },
      // 点击下一步或者取消
      preStep() {
        if (this.activeItemIndex == 0) {
          return
        } else if (this.activeItemIndex == 10) {
          // 数据初始化
          this.salary = {
            basicSalary: 0,
            trafficSalary: 0,
            lunchSalary: 0,
            bonus: 0,
            pensionPer: 0,
            pensionBase: 0,
            medicalPer: 0,
            medicalBase: 0,
            accumulationFundPer: 0,
            accumulationFundBase: 0,
            name: ''
          }
          this.activeItemIndex = 0
          // 关闭对话框
          this.dialogVisible = false
          return
        }
        this.activeItemIndex--;
      }
    }
  }
</script>
```

## 1.3. 前后端 - 添加工资账套 开发

后端：

Controller 层

```java
@RestController
@RequestMapping("/salary/sob")
public class SalaryController {
  @Autowired
  SalaryService salaryService;

  @PostMapping("/")
  public RespBean addSalary(@RequestBody Salary salary) {
    if (salaryService.addSalary(salary) == 1) {
      return RespBean.ok("添加成功！");
    }
    return RespBean.error("添加失败！");
  }
}
```

Service 层

```java
@Service
public class SalaryService {
  @Autowired
  SalaryMapper salaryMapper;

  public Integer addSalary(Salary salary) {
    salary.setCreateDate(new Date());
    return salaryMapper.insertSelective(salary);
  }
}
```

---

前端

```vue
<template>
<div>
  <div style="display: flex;justify-content: space-between">
    <el-button icon="el-icon-plus" type="primary" @click="showAddSalaryView">添加工资账套</el-button>
  </div>
  <el-dialog
             title="添加工资账套"
             :visible.sync="dialogVisible"
             width="50%">
    <div style="display: flex; justify-content: space-around;align-items: center">
      <el-steps direction="vertical" :active="activeItemIndex">
        <el-step :title="itemName" v-for="(itemName,index) in salaryItemName" :key="index"></el-step>
  </el-steps>
      <el-input v-model="salary[title]" :placeholder="'请输入'+ salaryItemName[index] +'...' "
                v-for="(value,title,index) in salary"
                :key="index" v-show="activeItemIndex==index" style="width: 200px;"></el-input>
  </div>
    <span slot="footer" class="dialog-footer">
      <el-button @click="preStep">{{activeItemIndex==10?'取消':'上一步'}}</el-button>
      <el-button type="primary" @click="nextStep">{{activeItemIndex==10?'完成':'下一步'}}</el-button>
  </span>
  </el-dialog>
  </div>
</template>

<script>
  export default {
    name: "SalSob",
    data() {
      return {
        salaries: [],
        dialogVisible: false,
        activeItemIndex: 0,
        salaryItemName: [
          '基本工资',
          '交通补助',
          '午餐补助',
          '奖金',
          '养老金比率',
          '养老金基数',
          '医疗保险比率',
          '医疗保险基数',
          '公积金比率',
          '公积金基数',
          '账套名称'
        ],
        salary: {
          basicSalary: 0,
          trafficSalary: 0,
          lunchSalary: 0,
          bonus: 0,
          pensionPer: 0,
          pensionBase: 0,
          medicalPer: 0,
          medicalBase: 0,
          accumulationFundPer: 0,
          accumulationFundBase: 0,
          name: ''
        }
      }
    },
    mounted() {
      this.initSalaries();
    },
    methods: {
      // 加载 Salary
      initSalaries() {
        this.getRequest("/salary/sob/").then(res => {
          if (res) {
            this.salaries = res;
          }
        })
      },
      showAddSalaryView() {
        this.dialogVisible = true
      },
      // 点击上一步或者完成
      nextStep() {
        if (this.activeItemIndex == 10) {
          this.postRequest("/salary/sob/", this.salary).then(res => {
            if (res) {
              this.initSalaries();
              this.dialogVisible = false
            }
          })
          return
        }
        this.activeItemIndex++
      },
      // 点击下一步或者取消
      preStep() {
        if (this.activeItemIndex == 0) {
          return
        } else if (this.activeItemIndex == 10) {
          // 数据初始化
          this.salary = {
            basicSalary: 0,
            trafficSalary: 0,
            lunchSalary: 0,
            bonus: 0,
            pensionPer: 0,
            pensionBase: 0,
            medicalPer: 0,
            medicalBase: 0,
            accumulationFundPer: 0,
            accumulationFundBase: 0,
            name: ''
          }
          this.activeItemIndex = 0
          // 关闭对话框
          this.dialogVisible = false
          return
        }
        this.activeItemIndex--;
      }
    }
  }
</script>
```

## 1.4. 前后端 - 删除工资账套 开发

后端

Controller 层

```java
@RestController
@RequestMapping("/salary/sob")
public class SalaryController {
  @Autowired
  SalaryService salaryService;
  @DeleteMapping("/{id}")
  public RespBean deleteSalaryById(@PathVariable Integer id){
    if (salaryService.deleteSalaryById(id) == 1){
      return RespBean.ok("删除成功！");
    }
    return RespBean.error("删除失败！");
  }
}
```

Service 层

```java
@Service
public class SalaryService {
  @Autowired
  SalaryMapper salaryMapper;
  public Integer deleteSalaryById(Integer id) {
    return salaryMapper.deleteByPrimaryKey(id);
  }
}
```

---

前端：

```vue
<template>
<div style="margin-top: 10px;">
  <el-table :data="salaries">
    <el-table-column label="操作">
      <template slot-scope="scope">
        <el-button>编辑</el-button>
        <el-button type="danger" @click="deleteSalary(scope.row)">删除</el-button>
</template>
</el-table-column>
</el-table>
</div>
</template>

<script>
  export default {
    name: "SalSob",
    methods: {// 删除按钮点击事件
      deleteSalary(data){
        this.$confirm('此操作将删除【'+data.name+'】账套，是否继续？', '提示', {
          cancelButtonText: '取消',
          confirmButtonText: '确认',
        }).then(()=>{
          this.deleteRequest("/salary/sob/"+ data.id).then(res=>{
            if(res){
              this.initSalaries()
            }
          })
        }).catch(()=>{
          this.$message.info('取消删除！')
        })
      }
    }
  }
</script>
```

## 1.5. 前后端 - 编辑工资账套 开发

后端

Controller层

```java
@RestController
@RequestMapping("/salary/sob")
public class SalaryController {

  @Autowired
  SalaryService salaryService;
  @PutMapping("/")
  public RespBean updateSalaryById(@RequestBody Salary salary){
    if(salaryService.updateSalaryById(salary) == 1 ){
      return RespBean.ok("更新成功！");
    }
    return RespBean.error("更新失败！");
  }
}
```

Service层

```java
@Service
public class SalaryService {

  @Autowired
  SalaryMapper salaryMapper;
  public Integer updateSalaryById(Salary salary) {
    return salaryMapper.updateByPrimaryKeySelective(salary);
  }
}
```

前端

* 给 dialog 弹窗 动态修改 title 值，如果是点击编辑操作则 title 为编辑、如果是点击添加则 title 为添加

```vue
<template>
<div>
  <el-table :data="salaries">
    <el-table-column label="操作">
      <template slot-scope="scope">
        <el-button @click="showEditSalaryView(scope.row)">编辑</el-button>
</template>
</el-table-column>
</el-table>
<el-dialog
           :title="dialogTitle"
           :visible.sync="dialogVisible"
           width="50%">
  <div style="display: flex; justify-content: space-around;align-items: center">
    <el-steps direction="vertical" :active="activeItemIndex">
      <el-step :title="itemName" v-for="(itemName,index) in salaryItemName" :key="index"></el-step>
    </el-steps>
    <el-input v-model="salary[title]" :placeholder="'请输入'+ salaryItemName[index] +'...' "
              v-for="(value,title,index) in salary"
              :key="index" v-show="activeItemIndex==index" style="width: 200px;"
              @keydown.native.enter="nextStep"></el-input>
  </div>
  <span slot="footer" class="dialog-footer">
    <el-button @click="preStep">{{activeItemIndex==10?'取消':'上一步'}}</el-button>
    <el-button type="primary" @click="nextStep">{{activeItemIndex==10?'完成':'下一步'}}</el-button>
  </span>
</el-dialog>
</div>
</template>

<script>
  export default {
    name: "SalSob",
    data() {
      return {
        salaries: [],
        dialogVisible: false,
        dialogTitle: "",
        salary: {
          basicSalary: 0,
          trafficSalary: 0,
          lunchSalary: 0,
          bonus: 0,
          pensionPer: 0,
          pensionBase: 0,
          medicalPer: 0,
          medicalBase: 0,
          accumulationFundPer: 0,
          accumulationFundBase: 0,
          name: ''
        },

      }
    },
    methods: {
      // 添加操作
      showAddSalaryView() {
        this.dialogTitle = '添加工资账套';
        this.dialogVisible = true;
        // 数据初始化
        this.initSalary()
        this.activeItemIndex = 0
      },
      // 点击上一步或者完成
      nextStep() {
        if (this.activeItemIndex == 10) {
          // 当id存在则为更新操作否则则为添加操作
          if (this.salary.id) {
            this.putRequest("/salary/sob/", this.salary).then(res => {
              if (res) {
                this.initSalaries();
                this.dialogVisible = false;
              }
            })
          } else {
            this.postRequest("/salary/sob/", this.salary).then(res => {
              if (res) {
                this.initSalaries();
                this.dialogVisible = false;
              }
            })
          }
          return;
        }
        this.activeItemIndex++;
      },
      // 编辑按钮
      showEditSalaryView(data) {
        this.initSalary();
        this.activeItemIndex = 0;
        this.dialogTitle = '编辑工资账套';
        this.dialogVisible = true
        // 将数据copy后添加多一个 id 属性
        Object.assign(this.salary, data);
        this.salary.id = data.id;
      },
      // 数据初始化
      initSalary() {
        this.salary = {
          basicSalary: 0,
          trafficSalary: 0,
          lunchSalary: 0,
          bonus: 0,
          pensionPer: 0,
          pensionBase: 0,
          medicalPer: 0,
          medicalBase: 0,
          accumulationFundPer: 0,
          accumulationFundBase: 0,
          name: ''
        };
      }
    }
  }
</script>
```

## 1.5. 工资账套管理开发完成

```vue
<template>
<div>
  <div style="display: flex;justify-content: space-between">
    <el-button icon="el-icon-plus" type="primary" @click="showAddSalaryView">添加工资账套</el-button>
    <el-button icon="el-icon-refresh" type="success" @click="initSalaries"></el-button>
  </div>
  <div style="margin-top: 10px;">
    <el-table :data="salaries">
      <el-table-column type="selection" width="55"></el-table-column>
      <el-table-column width="120" prop="name" label="账套名称"></el-table-column>
      <el-table-column width="70" prop="basicSalary" label="基本工资"></el-table-column>
      <el-table-column width="70" prop="trafficSalary" label="交通补助"></el-table-column>
      <el-table-column width="70" prop="lunchSalary" label="午餐补助"></el-table-column>
      <el-table-column width="70" prop="bonus" label="奖金"></el-table-column>
      <el-table-column width="100" prop="createDate" label="启用时间"></el-table-column>
      <el-table-column label="养老金" align="center">
        <el-table-column width="70" prop="pensionPer" label="比率"></el-table-column>
        <el-table-column width="70" prop="pensionBase" label="基数"></el-table-column>
  </el-table-column>
      <el-table-column label="医疗保险" align="center">
        <el-table-column width="70" prop="medicalPer" label="比率"></el-table-column>
        <el-table-column width="70" prop="medicalBase" label="基数"></el-table-column>
  </el-table-column>
      <el-table-column label="公积金" align="center">
        <el-table-column width="70" prop="accumulationFundPer" label="比率"></el-table-column>
        <el-table-column width="70" prop="accumulationFundPer" label="基数"></el-table-column>
  </el-table-column>
      <el-table-column label="操作">
        <template slot-scope="scope">
          <el-button @click="showEditSalaryView(scope.row)">编辑</el-button>
          <el-button type="danger" @click="deleteSalary(scope.row)">删除</el-button>
</template>
</el-table-column>
</el-table>
</div>
<el-dialog
           :title="dialogTitle"
           :visible.sync="dialogVisible"
           width="50%">
  <div style="display: flex; justify-content: space-around;align-items: center">
    <el-steps direction="vertical" :active="activeItemIndex">
      <el-step :title="itemName" v-for="(itemName,index) in salaryItemName" :key="index"></el-step>
    </el-steps>
    <el-input v-model="salary[title]" :placeholder="'请输入'+ salaryItemName[index] +'...' "
              v-for="(value,title,index) in salary"
              :key="index" v-show="activeItemIndex==index" style="width: 200px;"
              @keydown.native.enter="nextStep"></el-input>
  </div>
  <span slot="footer" class="dialog-footer">
    <el-button @click="preStep">{{activeItemIndex==10?'取消':'上一步'}}</el-button>
    <el-button type="primary" @click="nextStep">{{activeItemIndex==10?'完成':'下一步'}}</el-button>
  </span>
</el-dialog>
</div>
</template>

<script>
  export default {
    name: "SalSob",
    data() {
      return {
        salaries: [],
        dialogVisible: false,
        dialogTitle: "",
        activeItemIndex: 0,
        salaryItemName: [
          '基本工资',
          '交通补助',
          '午餐补助',
          '奖金',
          '养老金比率',
          '养老金基数',
          '医疗保险比率',
          '医疗保险基数',
          '公积金比率',
          '公积金基数',
          '账套名称'
        ],
        salary: {
          basicSalary: 0,
          trafficSalary: 0,
          lunchSalary: 0,
          bonus: 0,
          pensionPer: 0,
          pensionBase: 0,
          medicalPer: 0,
          medicalBase: 0,
          accumulationFundPer: 0,
          accumulationFundBase: 0,
          name: ''
        },

      }
    },
    mounted() {
      this.initSalaries();
    },
    methods: {
      // 加载 Salary
      initSalaries() {
        this.getRequest("/salary/sob/").then(res => {
          if (res) {
            this.salaries = res;
          }
        })
      },
      // 添加操作
      showAddSalaryView() {
        this.dialogTitle = '添加工资账套';
        this.dialogVisible = true;
        // 数据初始化
        this.initSalary()
        this.activeItemIndex = 0
      },
      // 点击上一步或者完成
      nextStep() {
        if (this.activeItemIndex == 10) {
          if (this.salary.id) {
            this.putRequest("/salary/sob/", this.salary).then(res => {
              if (res) {
                this.initSalaries();
                this.dialogVisible = false;
              }
            })
          } else {
            this.postRequest("/salary/sob/", this.salary).then(res => {
              if (res) {
                this.initSalaries();
                this.dialogVisible = false;
              }
            })
          }
          return;
        }
        this.activeItemIndex++;
      },
      // 点击下一步或者取消
      preStep() {
        if (this.activeItemIndex == 0) {
          return
        } else if (this.activeItemIndex == 10) {
          // 关闭对话框
          this.dialogVisible = false;
          return
        }
        this.activeItemIndex--;
      },
      // 删除按钮点击事件
      deleteSalary(data) {
        this.$confirm('此操作将删除【' + data.name + '】账套，是否继续？', '提示', {
          cancelButtonText: '取消',
          confirmButtonText: '确认',
        }).then(() => {
          this.deleteRequest("/salary/sob/" + data.id).then(res => {
            if (res) {
              this.initSalaries();
            }
          })
        }).catch(() => {
          this.$message.info('取消删除！');
        })
      },
      // 编辑按钮
      showEditSalaryView(data) {
        this.initSalary();
        this.activeItemIndex = 0;
        this.dialogTitle = '编辑工资账套';
        this.dialogVisible = true
        Object.assign(this.salary, data);
        this.salary.id = data.id;
      },
      // 数据初始化
      initSalary() {
        this.salary = {
          basicSalary: 0,
          trafficSalary: 0,
          lunchSalary: 0,
          bonus: 0,
          pensionPer: 0,
          pensionBase: 0,
          medicalPer: 0,
          medicalBase: 0,
          accumulationFundPer: 0,
          accumulationFundBase: 0,
          name: ''
        };
      }
    }
  }
</script>

<style scoped>

</style>
```















































